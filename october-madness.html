<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>October Madness: Better late than never - DataRambler</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://www.datarambler.com/october-madness.html">

        <meta name="author" content="Jeorry Balasabas" />
        <meta name="keywords" content="python,machine learning,data science" />
        <meta name="description" content="March Madness in October?¶This post is a long time coming. Honestly, I meant to get this out last March but better late than never. This notebook was the method I used in cleansing and exploring data from the 2017 Kaggle Machine Learning Mania competition. You could apply these techniques to any data where you are trying to predict a winner based off prior information. If you are interested in competing in a Kaggle competition I highly recommend this one. Especially if you are getting tired of Titanic datasets and flower petal measurements. Reading the past competition message boards was a huge help. I’ll try to sprinkle my thought process at different points to clarify for readers. Enjoy!" />

        <meta property="og:site_name" content="DataRambler" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="October Madness: Better late than never"/>
        <meta property="og:url" content="https://www.datarambler.com/october-madness.html"/>
        <meta property="og:description" content="March Madness in October?¶This post is a long time coming. Honestly, I meant to get this out last March but better late than never. This notebook was the method I used in cleansing and exploring data from the 2017 Kaggle Machine Learning Mania competition. You could apply these techniques to any data where you are trying to predict a winner based off prior information. If you are interested in competing in a Kaggle competition I highly recommend this one. Especially if you are getting tired of Titanic datasets and flower petal measurements. Reading the past competition message boards was a huge help. I’ll try to sprinkle my thought process at different points to clarify for readers. Enjoy!"/>
        <meta property="article:published_time" content="2017-10-18" />
            <meta property="article:section" content="Machine Learning" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="machine learning" />
            <meta property="article:tag" content="data science" />
            <meta property="article:author" content="Jeorry Balasabas" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://www.datarambler.com/theme/css/bootstrap.simplex.min.css" type="text/css"/>
    <link href="https://www.datarambler.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://www.datarambler.com/theme/css/pygments/native.css" rel="stylesheet">
        <link href="https://www.datarambler.com/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="https://www.datarambler.com/theme/css/style.css" type="text/css"/>





</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://www.datarambler.com/" class="navbar-brand">
DataRambler            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="https://www.datarambler.com/pages/about.html">
                             About
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://www.datarambler.com/october-madness.html"
                       rel="bookmark"
                       title="Permalink to October Madness: Better late than never">
                        October Madness: Better late than&nbsp;never
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2017-10-18T17:00:00-04:00"> Wed 18 October 2017</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://www.datarambler.com/tag/python.html">python</a>
        /
	<a href="https://www.datarambler.com/tag/machine-learning.html">machine learning</a>
        /
	<a href="https://www.datarambler.com/tag/data-science.html">data science</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <style type="text/css">/*!
*
* IPython notebook
*
*/
/* <span class="caps">CSS</span> font colors for translated <span class="caps">ANSI</span> colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #<span class="caps">90CAF9</span>;
  border-left-color: #<span class="caps">E3F2FD</span>;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #<span class="caps">E3F2FD</span>;
  border-right-width: 1px;
  background: #<span class="caps">E3F2FD</span>;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #<span class="caps">42A5F5</span> -40px, #<span class="caps">42A5F5</span> 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #<span class="caps">42A5F5</span> -40px, #<span class="caps">42A5F5</span> 7px, #<span class="caps">E3F2FD</span> 7px, #<span class="caps">E3F2FD</span> 100%);
}
.edit_mode div.cell.selected {
  border-color: #<span class="caps">66BB6A</span>;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #<span class="caps">66BB6A</span> -40px, #<span class="caps">66BB6A</span> 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #<span class="caps">303F9F</span>;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In <span class="caps">CM2</span>, this used to be 0.4em, but in <span class="caps">CM3</span> it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In <span class="caps">CM3</span> this went to 4px from 0 in <span class="caps">CM2</span>. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #<span class="caps">BA2121</span>;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #<span class="caps">AA22FF</span>;
  font-weight: bold;
}
.highlight-meta {
  color: #<span class="caps">AA22FF</span>;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #<span class="caps">AA22FF</span>;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #<span class="caps">BA2121</span>;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #<span class="caps">AA22FF</span>;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but <span class="caps">FF</span> barfs all over that */
  height: 24em;
  /* <span class="caps">FF</span> needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/<span class="caps">FF</span> */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #<span class="caps">FF0000</span> } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #<span class="caps">BC7A00</span> } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #<span class="caps">FF0000</span> } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #<span class="caps">0044DD</span> } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #<span class="caps">BA2121</span> } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #<span class="caps">0000FF</span>; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #<span class="caps">AA22FF</span> } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #<span class="caps">D2413A</span>; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #<span class="caps">0000FF</span> } /* Name.Function */
.highlight .nl { color: #<span class="caps">A0A000</span> } /* Name.Label */
.highlight .nn { color: #<span class="caps">0000FF</span>; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #<span class="caps">AA22FF</span>; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #<span class="caps">BA2121</span> } /* Literal.String.Affix */
.highlight .sb { color: #<span class="caps">BA2121</span> } /* Literal.String.Backtick */
.highlight .sc { color: #<span class="caps">BA2121</span> } /* Literal.String.Char */
.highlight .dl { color: #<span class="caps">BA2121</span> } /* Literal.String.Delimiter */
.highlight .sd { color: #<span class="caps">BA2121</span>; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #<span class="caps">BA2121</span> } /* Literal.String.Double */
.highlight .se { color: #<span class="caps">BB6622</span>; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #<span class="caps">BA2121</span> } /* Literal.String.Heredoc */
.highlight .si { color: #<span class="caps">BB6688</span>; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #<span class="caps">BB6688</span> } /* Literal.String.Regex */
.highlight .s1 { color: #<span class="caps">BA2121</span> } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #<span class="caps">0000FF</span> } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #<span class="caps">3E424D</span>; }
.ansi-black-bg { background-color: #<span class="caps">3E424D</span>; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #<span class="caps">E75C58</span>; }
.ansi-red-bg { background-color: #<span class="caps">E75C58</span>; }
.ansi-red-intense-fg { color: #<span class="caps">B22B31</span>; }
.ansi-red-intense-bg { background-color: #<span class="caps">B22B31</span>; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #<span class="caps">DDB62B</span>; }
.ansi-yellow-bg { background-color: #<span class="caps">DDB62B</span>; }
.ansi-yellow-intense-fg { color: #<span class="caps">B27D12</span>; }
.ansi-yellow-intense-bg { background-color: #<span class="caps">B27D12</span>; }
.ansi-blue-fg { color: #<span class="caps">208FFB</span>; }
.ansi-blue-bg { background-color: #<span class="caps">208FFB</span>; }
.ansi-blue-intense-fg { color: #<span class="caps">0065CA</span>; }
.ansi-blue-intense-bg { background-color: #<span class="caps">0065CA</span>; }
.ansi-magenta-fg { color: #<span class="caps">D160C4</span>; }
.ansi-magenta-bg { background-color: #<span class="caps">D160C4</span>; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #<span class="caps">60C6C8</span>; }
.ansi-cyan-bg { background-color: #<span class="caps">60C6C8</span>; }
.ansi-cyan-intense-fg { color: #<span class="caps">258F8F</span>; }
.ansi-cyan-intense-bg { background-color: #<span class="caps">258F8F</span>; }
.ansi-white-fg { color: #<span class="caps">C5C1B4</span>; }
.ansi-white-bg { background-color: #<span class="caps">C5C1B4</span>; }
.ansi-white-intense-fg { color: #<span class="caps">A1A6B2</span>; }
.ansi-white-intense-bg { background-color: #<span class="caps">A1A6B2</span>; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="March-Madness-in-October?">March Madness in October?<a class="anchor-link" href="#March-Madness-in-October?">¶</a></h1><p>This post is a long time coming. Honestly, I meant to get this out last March but better late than never. This notebook was the method I used in cleansing and exploring data from the <a href="https://www.kaggle.com/c/march-machine-learning-mania-2017">2017 Kaggle Machine Learning Mania</a> competition. You could apply these techniques to any data where you are trying to predict a winner based off prior information. If you are interested in competing in a 
Kaggle competition I highly recommend this one. Especially if you are getting tired of Titanic datasets and flower petal measurements. Reading the past competition message boards was a huge help. I&#8217;ll try to sprinkle my thought process at different points to clarify for readers.&nbsp;Enjoy!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">fuzzywuzzy</span> <span class="k">import</span> <span class="n">process</span><span class="p">,</span> <span class="n">fuzz</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Exploration">Data Exploration<a class="anchor-link" href="#Data-Exploration">¶</a></h2><p>At this point I just wanted to see what kind of data I was dealing with. Luckily, kaggle already assigned each team a Team <span class="caps">ID</span> to keep me from having to perform any kind of&nbsp;normalization.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">teams</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./Teams.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pwd</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">teams</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Of course I had to find out the team id of the home team.&nbsp;:)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">teams</span><span class="p">[</span><span class="n">teams</span><span class="p">[</span><span class="s1">'Team_Name'</span><span class="p">]</span><span class="o">==</span><span class="s1">'Georgia Tech'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also look up teams by team&nbsp;id.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">teams</span><span class="p">[</span><span class="n">teams</span><span class="p">[</span><span class="s1">'Team_Id'</span><span class="p">]</span><span class="o">==</span><span class="mi">1455</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rscr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./RegularSeasonCompactResults.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rsdr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./RegularSeasonDetailedResults.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tcr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./TourneyCompactResults.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The kenpom.csv is a external dataset that I obtained by scraping <a href="https://kenpom.com/">https://kenpom.com/</a>. I highly recommend looking at and consider using data from this site. Ken Pomeroy runs a college basketball ranking site and was recommended in previous march madness&nbsp;competitions.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./sample_submission.csv"</span><span class="p">)</span>
<span class="n">kp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./kenpom.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rscr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometimes it&#8217;s easier to view all the features by transposing the&nbsp;dataframe.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rsdr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rscr</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rsdr</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>No surprise here on the top 10 teams by total&nbsp;wins.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">top_10_reg</span> <span class="o">=</span> <span class="n">teams</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rscr</span><span class="p">[</span><span class="s1">'Wteam'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[:</span><span class="mi">9</span><span class="p">]),</span> <span class="n">how</span><span class="o">=</span><span class="s1">'right'</span><span class="p">)</span>
<span class="n">top_10_reg</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Team_Name'</span><span class="p">,</span> <span class="s1">'Total_Wins'</span><span class="p">]</span>
<span class="n">top_10_reg</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The feature we are trying to predict is the probability that team1 will win. In order to do this effectively we need to choose or engineer numerical features that we&#8217;ll know prior to the game occurring. The makeup of each team varies greatly from year to year. With that in mind I&#8217;ve decided to isolate my train and test data by&nbsp;year.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013</span> <span class="o">=</span> <span class="n">rsdr</span><span class="p">[</span><span class="n">rsdr</span><span class="p">[</span><span class="s1">'Season'</span><span class="p">]</span><span class="o">==</span><span class="mi">2013</span><span class="p">]</span>
<span class="n">rs2014</span> <span class="o">=</span> <span class="n">rsdr</span><span class="p">[</span><span class="n">rsdr</span><span class="p">[</span><span class="s1">'Season'</span><span class="p">]</span><span class="o">==</span><span class="mi">2014</span><span class="p">]</span>
<span class="n">rs2015</span> <span class="o">=</span> <span class="n">rsdr</span><span class="p">[</span><span class="n">rsdr</span><span class="p">[</span><span class="s1">'Season'</span><span class="p">]</span><span class="o">==</span><span class="mi">2015</span><span class="p">]</span>
<span class="n">rs2016</span> <span class="o">=</span> <span class="n">rsdr</span><span class="p">[</span><span class="n">rsdr</span><span class="p">[</span><span class="s1">'Season'</span><span class="p">]</span><span class="o">==</span><span class="mi">2016</span><span class="p">]</span>
<span class="n">rs2017</span> <span class="o">=</span> <span class="n">rsdr</span><span class="p">[</span><span class="n">rsdr</span><span class="p">[</span><span class="s1">'Season'</span><span class="p">]</span><span class="o">==</span><span class="mi">2017</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2014_d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2015_d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2016_d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2017_d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2014_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2015_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2016_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2017_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d1</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2013</span><span class="p">[[</span><span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span>  <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2014_d1</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2014</span><span class="p">[[</span><span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span>  <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2015_d1</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2015</span><span class="p">[[</span><span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span>  <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2016_d1</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2016</span><span class="p">[[</span><span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span>  <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2017_d1</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rs2017</span><span class="p">[[</span><span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d2</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2013</span><span class="p">[[</span><span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">,</span> <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2014_d2</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2014</span><span class="p">[[</span><span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">,</span> <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2015_d2</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2015</span><span class="p">[[</span><span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">,</span> <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2016_d2</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2016</span><span class="p">[[</span><span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">,</span> <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2017_d2</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rs2017</span><span class="p">[[</span><span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d1</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rs2014_d1</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rs2015_d1</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rs2016_d1</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rs2017_d1</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d2</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rs2014_d2</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rs2015_d2</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rs2016_d2</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rs2017_d2</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rs2013_d1</span><span class="p">,</span> <span class="n">rs2013_d2</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rs2014_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rs2014_d1</span><span class="p">,</span> <span class="n">rs2014_d2</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rs2015_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rs2015_d1</span><span class="p">,</span> <span class="n">rs2015_d2</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rs2016_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rs2016_d1</span><span class="p">,</span> <span class="n">rs2016_d2</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rs2017_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rs2017_d1</span><span class="p">,</span> <span class="n">rs2017_d2</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I did a little feature engineering by creating standard bball&nbsp;percentages.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fga'</span><span class="p">]</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fga3'</span><span class="p">]</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fta'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fga'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fga3'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fta'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fga'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fga3'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fta'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fga'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fga3'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fta'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fga'</span><span class="p">]</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fga3'</span><span class="p">]</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fta'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fga'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fga3'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fta'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fga'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fga3'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fta'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fga'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fga3'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fta'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I added a few more features by calculating each team&#8217;s trailing average for bbal percentages to try and encapsulate how a team was doing at that point in&nbsp;time.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_train</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Daynum'</span><span class="p">)</span>
<span class="n">rs2014_train</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Daynum'</span><span class="p">)</span>
<span class="n">rs2015_train</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Daynum'</span><span class="p">)</span>
<span class="n">rs2016_train</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Daynum'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_fg_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_fg3_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg3_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ft_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ft_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ast_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ast_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_dr_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_dr_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_stl_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_stl_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_pf_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_pf_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_blk_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_blk_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_fg_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_fg3_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg3_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ft_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ft_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ast_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ast_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_dr_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_dr_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_stl_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_stl_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_pf_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_pf_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_blk_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_blk_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_fg_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_fg3_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg3_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ft_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ft_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ast_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ast_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_dr_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_dr_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_stl_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_stl_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_pf_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_pf_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_blk_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_blk_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_fg_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_fg3_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg3_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ft_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ft_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ast_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ast_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_dr_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_dr_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_stl_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_stl_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_pf_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_pf_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_blk_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_blk_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t2_fg_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_fg3_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg3_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ft_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ft_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ast_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ast_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_dr_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_dr_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_stl_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_stl_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_pf_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_pf_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_blk_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_blk_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t2_fg_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_fg3_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg3_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ft_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ft_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ast_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ast_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_dr_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_dr_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_stl_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_stl_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_pf_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_pf_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_blk_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_blk_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t2_fg_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_fg3_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg3_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ft_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ft_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ast_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ast_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_dr_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_dr_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_stl_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_stl_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_pf_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_pf_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_blk_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_blk_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t2_fg_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_fg3_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg3_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ft_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ft_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ast_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ast_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_dr_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_dr_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_stl_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_stl_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_pf_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_pf_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_blk_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_blk_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-the-Model">Training the Model<a class="anchor-link" href="#Training-the-Model">¶</a></h2><p>Now that my feature are how I want them it was time to train my model. I split my target variable, in this case whether team1 would win or lose (indicated by a 1 or 0 respectively) into it&#8217;s own&nbsp;array.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target13</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">target14</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">target15</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">target16</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I created my feature arrays separated by&nbsp;year.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features_array13</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">features_array14</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">features_array15</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">features_array16</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lrscores13</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logreg</span><span class="p">,</span> <span class="n">features_array13</span><span class="p">,</span> <span class="n">target13</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">lrscores14</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logreg</span><span class="p">,</span> <span class="n">features_array14</span><span class="p">,</span> <span class="n">target14</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">lrscores15</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logreg</span><span class="p">,</span> <span class="n">features_array15</span><span class="p">,</span> <span class="n">target15</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">lrscores16</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logreg</span><span class="p">,</span> <span class="n">features_array16</span><span class="p">,</span> <span class="n">target16</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lrscores13</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">lrscores14</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">lrscores15</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">lrscores16</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">rfscores13</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">features_array13</span><span class="p">,</span> <span class="n">target13</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">rfscores14</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">features_array14</span><span class="p">,</span> <span class="n">target14</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">rfscores15</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">features_array15</span><span class="p">,</span> <span class="n">target15</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">rfscores16</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">features_array16</span><span class="p">,</span> <span class="n">target16</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Random Forest CV Scores:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'min: </span><span class="si">{:.3f}</span><span class="s1">, mean; </span><span class="si">{:.3f}</span><span class="s1">, max: </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">rfscores13</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rfscores13</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">rfscores13</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'min: </span><span class="si">{:.3f}</span><span class="s1">, mean; </span><span class="si">{:.3f}</span><span class="s1">, max: </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">rfscores14</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rfscores14</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">rfscores14</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'min: </span><span class="si">{:.3f}</span><span class="s1">, mean; </span><span class="si">{:.3f}</span><span class="s1">, max: </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">rfscores15</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rfscores15</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">rfscores15</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'min: </span><span class="si">{:.3f}</span><span class="s1">, mean; </span><span class="si">{:.3f}</span><span class="s1">, max: </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">rfscores16</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rfscores16</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">rfscores16</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">GradientBoostingClassifier</span>

<span class="n">gb</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=.</span><span class="mi">8</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>

<span class="n">gbscores13</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="n">features_array13</span><span class="p">,</span> <span class="n">target13</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">gbscores14</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="n">features_array14</span><span class="p">,</span> <span class="n">target14</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">gbscores15</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="n">features_array15</span><span class="p">,</span> <span class="n">target15</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">gbscores16</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="n">features_array16</span><span class="p">,</span> <span class="n">target16</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Gradient Boosted Trees CV scores:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"min: </span><span class="si">{:.3f}</span><span class="s2">, mean: </span><span class="si">{:.3f}</span><span class="s2">, max: </span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">gbscores13</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gbscores13</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">gbscores13</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"min: </span><span class="si">{:.3f}</span><span class="s2">, mean: </span><span class="si">{:.3f}</span><span class="s2">, max: </span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">gbscores14</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gbscores14</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">gbscores14</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"min: </span><span class="si">{:.3f}</span><span class="s2">, mean: </span><span class="si">{:.3f}</span><span class="s2">, max: </span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">gbscores15</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gbscores15</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">gbscores15</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"min: </span><span class="si">{:.3f}</span><span class="s2">, mean: </span><span class="si">{:.3f}</span><span class="s2">, max: </span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">gbscores16</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gbscores16</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">gbscores16</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For now I&#8217;ll stick with Gradient Boosting as my classifier and I&#8217;ll start munging the test data that I&#8217;ll be using to make my predictions with. First I need to get the sample submission csv that Kaggle gave us into a format that I can use with&nbsp;scikit-learn.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ss</span><span class="p">[</span><span class="s1">'team1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ss</span><span class="p">[</span><span class="s1">'team2'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ss</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'pred'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ss</span><span class="p">[[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>
<span class="n">ss13</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[</span><span class="n">ss</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span><span class="o">==</span><span class="mi">2013</span><span class="p">]</span>
<span class="n">ss14</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[</span><span class="n">ss</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span><span class="o">==</span><span class="mi">2014</span><span class="p">]</span>
<span class="n">ss15</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[</span><span class="n">ss</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span><span class="o">==</span><span class="mi">2015</span><span class="p">]</span>
<span class="n">ss16</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[</span><span class="n">ss</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span><span class="o">==</span><span class="mi">2016</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2014_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2015_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2016_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_end</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rs2014_end</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rs2015_end</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rs2016_end</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_2013_end</span> <span class="o">=</span> <span class="n">rs2013_end</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">]]</span>
<span class="n">ss13</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss13</span><span class="p">,</span> <span class="n">t1_2013_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>
<span class="n">t2_2013_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">t2_2013_end</span><span class="p">[[</span><span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t1_2013_end</span>
<span class="n">ss13</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss13</span><span class="p">,</span> <span class="n">t2_2013_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_2014_end</span> <span class="o">=</span> <span class="n">rs2014_end</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">]]</span>
<span class="n">ss14</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss14</span><span class="p">,</span> <span class="n">t1_2014_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>
<span class="n">t2_2014_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">t2_2014_end</span><span class="p">[[</span><span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t1_2014_end</span>
<span class="n">ss14</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss14</span><span class="p">,</span> <span class="n">t2_2014_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_2015_end</span> <span class="o">=</span> <span class="n">rs2015_end</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">]]</span>
<span class="n">ss15</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss15</span><span class="p">,</span> <span class="n">t1_2015_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>
<span class="n">t2_2015_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">t2_2015_end</span><span class="p">[[</span><span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t1_2015_end</span>
<span class="n">ss15</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss15</span><span class="p">,</span> <span class="n">t2_2015_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_2016_end</span> <span class="o">=</span> <span class="n">rs2016_end</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">]]</span>
<span class="n">ss16</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss16</span><span class="p">,</span> <span class="n">t1_2016_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>
<span class="n">t2_2016_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">t2_2016_end</span><span class="p">[[</span><span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t1_2016_end</span>
<span class="n">ss16</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss16</span><span class="p">,</span> <span class="n">t2_2016_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_13</span> <span class="o">=</span> <span class="n">ss13</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_14</span> <span class="o">=</span> <span class="n">ss14</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_15</span> <span class="o">=</span> <span class="n">ss15</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_16</span> <span class="o">=</span> <span class="n">ss16</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_array13</span><span class="p">,</span> <span class="n">target13</span><span class="p">)</span>
<span class="n">t1_pred_prob_2013</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_13</span><span class="p">)</span>

<span class="n">gb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_array14</span><span class="p">,</span> <span class="n">target14</span><span class="p">)</span>
<span class="n">t1_pred_prob_2014</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_14</span><span class="p">)</span>

<span class="n">gb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_array15</span><span class="p">,</span> <span class="n">target15</span><span class="p">)</span>
<span class="n">t1_pred_prob_2015</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_15</span><span class="p">)</span>

<span class="n">gb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_array16</span><span class="p">,</span> <span class="n">target16</span><span class="p">)</span>
<span class="n">t1_pred_prob_2016</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds13</span> <span class="o">=</span> <span class="n">t1_pred_prob_2013</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ss13</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds13</span>
<span class="n">preds14</span> <span class="o">=</span> <span class="n">t1_pred_prob_2014</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ss14</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds14</span>
<span class="n">preds15</span> <span class="o">=</span> <span class="n">t1_pred_prob_2015</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ss15</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds15</span>
<span class="n">preds16</span> <span class="o">=</span> <span class="n">t1_pred_prob_2016</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ss16</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds16</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss13</span> <span class="o">=</span> <span class="n">ss13</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]]</span>
<span class="n">ss14</span> <span class="o">=</span> <span class="n">ss14</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]]</span>
<span class="n">ss15</span> <span class="o">=</span> <span class="n">ss15</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]]</span>
<span class="n">ss16</span> <span class="o">=</span> <span class="n">ss16</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss13</span> <span class="o">=</span> <span class="n">ss13</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ss14</span> <span class="o">=</span> <span class="n">ss14</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ss15</span> <span class="o">=</span> <span class="n">ss15</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ss16</span> <span class="o">=</span> <span class="n">ss16</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#ss_3_10_1635 = pd.concat([ss13, ss14, ss15, ss16], ignore_index=True)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#ss_3_10_1635.to_csv('ss_3_10_1635.csv', index=False)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following section involves using data from Ken Pomeroy. Various publications have indicated that these features are helpful in predicting <span class="caps">NCAA</span>&nbsp;matchups.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">teams</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">teams</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At this point I only needed to concentrate on results from 2017. The second half of the competition involved predicting all outcomes for the teams that had been selected for the <span class="caps">NCAA</span> tournament and their associated&nbsp;probabilities.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_2017</span> <span class="o">=</span> <span class="n">kp</span><span class="p">[</span><span class="n">kp</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">==</span><span class="mi">2017</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># kp_2017['Team'] = kp_2017['Team'].apply(lambda x: difflib.get_close_matches(x, teams['Team_Name']))</span>
<span class="c1"># kp_id17 = pd.merge(teams, kp_2017, how='left', left_on='Team_Name', right_on='Team')</span>
<span class="c1"># kp_id17</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_2017</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_id2017</span> <span class="o">=</span> <span class="n">kp_id2017</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Team_Id'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_id2017</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">kp_id2017</span><span class="p">,</span> <span class="n">rs2017_train</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'Team_Id'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span> <span class="o">=</span> <span class="n">kp_feat_17</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Team_Name'</span><span class="p">:</span><span class="s1">'t1_name'</span><span class="p">,</span> <span class="s1">'Rank'</span><span class="p">:</span><span class="s1">'t1_rank'</span><span class="p">,</span> <span class="s1">'Conference'</span><span class="p">:</span><span class="s1">'t1_conf'</span><span class="p">,</span> 
                           <span class="s1">'Wins'</span><span class="p">:</span><span class="s1">'t1_wins'</span><span class="p">,</span> <span class="s1">'Losses'</span><span class="p">:</span><span class="s1">'t1_losses'</span><span class="p">,</span><span class="s1">'Pyth'</span><span class="p">:</span><span class="s1">'t1_pyth'</span><span class="p">,</span> <span class="s1">'AdjustO'</span><span class="p">:</span><span class="s1">'t1_adjusto'</span><span class="p">,</span>
                           <span class="s1">'AdjustD'</span><span class="p">:</span><span class="s1">'t1_adjustd'</span><span class="p">,</span> <span class="s1">'AdjustT'</span><span class="p">:</span><span class="s1">'t1_adjustt'</span><span class="p">,</span> <span class="s1">'Luck'</span><span class="p">:</span><span class="s1">'t1_luck'</span><span class="p">,</span> <span class="s1">'SOS Pyth'</span><span class="p">:</span><span class="s1">'t1_sospyth'</span><span class="p">,</span>
                           <span class="s1">'SOS OppO'</span><span class="p">:</span><span class="s1">'t1_sos_oppo'</span><span class="p">,</span> <span class="s1">'SOS OppD'</span><span class="p">:</span><span class="s1">'t1_sos_oppd'</span><span class="p">,</span> <span class="s1">'NCSOS Pyth'</span><span class="p">:</span><span class="s1">'t1_ncsos_pyth'</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'Team_Id'</span><span class="p">,</span> <span class="s1">'Team'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">kp_id2017</span><span class="p">,</span> <span class="n">kp_feat_17</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'Team_Id'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span> <span class="o">=</span> <span class="n">kp_feat_17</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Team_Name'</span><span class="p">:</span><span class="s1">'t2_name'</span><span class="p">,</span> <span class="s1">'Rank'</span><span class="p">:</span><span class="s1">'t2_rank'</span><span class="p">,</span> <span class="s1">'Conference'</span><span class="p">:</span><span class="s1">'t2_conf'</span><span class="p">,</span> 
                           <span class="s1">'Wins'</span><span class="p">:</span><span class="s1">'t2_wins'</span><span class="p">,</span> <span class="s1">'Losses'</span><span class="p">:</span><span class="s1">'t2_losses'</span><span class="p">,</span><span class="s1">'Pyth'</span><span class="p">:</span><span class="s1">'t2_pyth'</span><span class="p">,</span> <span class="s1">'AdjustO'</span><span class="p">:</span><span class="s1">'t2_adjusto'</span><span class="p">,</span>
                           <span class="s1">'AdjustD'</span><span class="p">:</span><span class="s1">'t2_adjustd'</span><span class="p">,</span> <span class="s1">'AdjustT'</span><span class="p">:</span><span class="s1">'t2_adjustt'</span><span class="p">,</span> <span class="s1">'Luck'</span><span class="p">:</span><span class="s1">'t2_luck'</span><span class="p">,</span> <span class="s1">'SOS Pyth'</span><span class="p">:</span><span class="s1">'t2_sospyth'</span><span class="p">,</span>
                           <span class="s1">'SOS OppO'</span><span class="p">:</span><span class="s1">'t2_sos_oppo'</span><span class="p">,</span> <span class="s1">'SOS OppD'</span><span class="p">:</span><span class="s1">'t2_sos_oppd'</span><span class="p">,</span> <span class="s1">'NCSOS Pyth'</span><span class="p">:</span><span class="s1">'t2_ncsos_pyth'</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'Seed_x'</span><span class="p">,</span> <span class="s1">'Team'</span><span class="p">,</span> <span class="s1">'AdjustO Rank_x'</span><span class="p">,</span> <span class="s1">'AdjustD Rank_x'</span><span class="p">,</span> <span class="s1">'AdjustT Rank_x'</span><span class="p">,</span> <span class="s1">'Luck Rank_x'</span><span class="p">,</span>
                <span class="s1">'SOS Pyth Rank_x'</span><span class="p">,</span> <span class="s1">'SOS OppO Rank_x'</span><span class="p">,</span> <span class="s1">'SOS OppD Rank_x'</span><span class="p">,</span> <span class="s1">'NCSOS Pyth Rank_x'</span><span class="p">,</span> <span class="s1">'Year_y'</span><span class="p">,</span> <span class="s1">'Seed_y'</span><span class="p">,</span> 
                <span class="s1">'AdjustO Rank_y'</span><span class="p">,</span> <span class="s1">'AdjustD Rank_y'</span><span class="p">,</span> <span class="s1">'AdjustT Rank_y'</span><span class="p">,</span> <span class="s1">'Luck Rank_y'</span><span class="p">,</span> <span class="s1">'SOS OppO Rank_y'</span><span class="p">,</span>
                <span class="s1">'SOS OppD Rank_y'</span><span class="p">,</span> <span class="s1">'NCSOS Pyth Rank_y'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'Team_Id'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target17</span> <span class="o">=</span> <span class="n">kp_feat_17</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features_array17</span> <span class="o">=</span> <span class="n">kp_feat_17</span><span class="p">[[</span><span class="s1">'t1_ncsos_pyth'</span><span class="p">,</span> <span class="s1">'t1_sos_oppd'</span><span class="p">,</span> <span class="s1">'t1_sos_oppo'</span><span class="p">,</span> <span class="s1">'t1_sospyth'</span><span class="p">,</span> <span class="s1">'t1_luck'</span><span class="p">,</span> <span class="s1">'t1_adjustt'</span><span class="p">,</span>
                               <span class="s1">'t1_adjusto'</span><span class="p">,</span> <span class="s1">'t1_adjustd'</span><span class="p">,</span> <span class="s1">'t1_pyth'</span><span class="p">,</span> <span class="s1">'t2_ncsos_pyth'</span><span class="p">,</span> <span class="s1">'t2_sos_oppd'</span><span class="p">,</span> <span class="s1">'t2_sos_oppo'</span><span class="p">,</span>
                               <span class="s1">'t2_sospyth'</span><span class="p">,</span> <span class="s1">'t2_luck'</span><span class="p">,</span> <span class="s1">'t2_adjustt'</span><span class="p">,</span> <span class="s1">'t2_adjusto'</span><span class="p">,</span> <span class="s1">'t2_adjustd'</span><span class="p">,</span> <span class="s1">'t2_pyth'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbscores17</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="n">features_array17</span><span class="p">,</span> <span class="n">target17</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Gradient Boosted Trees CV scores:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"min: </span><span class="si">{:.3f}</span><span class="s2">, mean: </span><span class="si">{:.3f}</span><span class="s2">, max: </span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">gbscores17</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gbscores17</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">gbscores17</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ssub</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./SampleSubmission.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ssub</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ssub</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ssub</span><span class="o">.</span><span class="n">Id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ssub</span><span class="p">[</span><span class="s1">'team1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ssub</span><span class="o">.</span><span class="n">Id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ssub</span><span class="p">[</span><span class="s1">'team2'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ssub</span><span class="o">.</span><span class="n">Id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ssub</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'Pred'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ssub</span><span class="p">[[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ssub</span><span class="p">[[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>
<span class="n">ss17</span> <span class="o">=</span> <span class="n">ssub</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span> <span class="o">=</span> <span class="n">ss17</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">teams</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'Team_Id'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For my final submission I decided to train my model using the regular season from 2017 and I used the features from the Ken Pomeroy ncaa statistics. The hardest part was getting the team names that Ken Pomeroy used to align with the team names that Kaggle provided in their data. After playing with multiple fuzzy string matching modules I found out that someone from Kaggle had already posted a file that had multiple spellings of team names with the official team id&#8217;s that Kaggle wanted in your submission file. This was a huge&nbsp;help.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp2017_end</span> <span class="o">=</span> <span class="n">kp_feat_17</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">kp2017_end</span><span class="p">[</span><span class="s1">'team1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">kp2017_end</span><span class="p">[</span><span class="s1">'team1'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>


<span class="n">t1_2017_end</span> <span class="o">=</span> <span class="n">kp2017_end</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'t1_ncsos_pyth'</span><span class="p">,</span> <span class="s1">'t1_sos_oppd'</span><span class="p">,</span> <span class="s1">'t1_sos_oppo'</span><span class="p">,</span> <span class="s1">'t1_sospyth'</span><span class="p">,</span> <span class="s1">'t1_luck'</span><span class="p">,</span>
                          <span class="s1">'t1_adjustt'</span><span class="p">,</span><span class="s1">'t1_adjusto'</span><span class="p">,</span> <span class="s1">'t1_adjustd'</span><span class="p">,</span> <span class="s1">'t1_pyth'</span><span class="p">]]</span>

<span class="n">ss17</span> <span class="o">=</span> <span class="n">ss17</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">t1_2017_end</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>

<span class="n">t2_2017_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">t2_2017_end</span><span class="p">[[</span><span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'t2_ncsos_pyth'</span><span class="p">,</span> <span class="s1">'t2_sos_oppd'</span><span class="p">,</span> <span class="s1">'t2_sos_oppo'</span><span class="p">,</span> <span class="s1">'t2_sospyth'</span><span class="p">,</span> <span class="s1">'t2_luck'</span><span class="p">,</span>
                          <span class="s1">'t2_adjustt'</span><span class="p">,</span><span class="s1">'t2_adjusto'</span><span class="p">,</span> <span class="s1">'t2_adjustd'</span><span class="p">,</span> <span class="s1">'t2_pyth'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t1_2017_end</span>

<span class="n">ss17</span> <span class="o">=</span> <span class="n">ss17</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">t2_2017_end</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
<span class="n">ss17</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_17</span> <span class="o">=</span> <span class="n">ss17</span><span class="p">[[</span><span class="s1">'t1_ncsos_pyth'</span><span class="p">,</span> <span class="s1">'t1_sos_oppd'</span><span class="p">,</span> <span class="s1">'t1_sos_oppo'</span><span class="p">,</span> <span class="s1">'t1_sospyth'</span><span class="p">,</span> <span class="s1">'t1_luck'</span><span class="p">,</span>
                <span class="s1">'t1_adjustt'</span><span class="p">,</span><span class="s1">'t1_adjusto'</span><span class="p">,</span> <span class="s1">'t1_adjustd'</span><span class="p">,</span> <span class="s1">'t1_pyth'</span><span class="p">,</span> <span class="s1">'t2_ncsos_pyth'</span><span class="p">,</span>
                <span class="s1">'t2_sos_oppd'</span><span class="p">,</span> <span class="s1">'t2_sos_oppo'</span><span class="p">,</span> <span class="s1">'t2_sospyth'</span><span class="p">,</span> <span class="s1">'t2_luck'</span><span class="p">,</span>
                <span class="s1">'t2_adjustt'</span><span class="p">,</span><span class="s1">'t2_adjusto'</span><span class="p">,</span> <span class="s1">'t2_adjustd'</span><span class="p">,</span> <span class="s1">'t2_pyth'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_array17</span><span class="p">,</span> <span class="n">target17</span><span class="p">)</span>
<span class="n">t1_pred_prob_2017</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_17</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds17</span> <span class="o">=</span> <span class="n">t1_pred_prob_2017</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ss17</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds17</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span> <span class="o">=</span> <span class="n">ss17</span><span class="p">[[</span><span class="s1">'Id'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span> <span class="o">=</span> <span class="n">ss17</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Id'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ss17.to_csv('kp_gb_2017.csv', index=False)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the end, I completely screwed up by thinking I had extra time to submit my result by assuming the deadline was in <span class="caps">EST</span>. In fact, it was in <span class="caps">UTC</span> and I completely missed the deadline. I had a lot of fun and plan on competing in the 2018 competition. In retrospect I probably need to find a way to incorporate Vegas odds in my model. Most of the research I read implied that Vegas odds were very helpful in predicting winners. I also need to figure out how to introduce a certain amount of randomness in the outcome. Research also indicates that the best any model can get to predicting the outcome of any sport in around 80%. I guess that&#8217;s why they say sports is the <span class="caps">ULTIMATE</span> reality&nbsp;tv.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <!-- AddThis Button END -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://github.com/jeorryb"><i class="fa fa-github-square fa-lg"></i> github</a></li>
    <li class="list-group-item"><a href="https://twitter.com/jeorryb"><i class="fa fa-twitter-square fa-lg"></i> twitter</a></li>
    <li class="list-group-item"><a href="https://www.linkedin.com/in/jeorry"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Twitter Timeline -->
<li class="list-group-item">
  <h4><i class="fa fa-twitter fa-lg"></i><span class="icon-label">Latest Tweets</span></h4>
  <div id="twitter_timeline">
    <a class="twitter-timeline" data-width="250" data-height="300" data-dnt="true" data-theme="light" href="https://twitter.com/@jeorryb">Tweets by @jeorryb</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</li>
<!-- End Sidebar/Twitter Timeline -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container-fluid">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2017 Jeorry Balasabas
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://www.datarambler.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://www.datarambler.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://www.datarambler.com/theme/js/respond.min.js"></script>

    <script src="https://www.datarambler.com/theme/js/bodypadding.js"></script>


        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-59322469c36b0975"></script>
</body>
</html>