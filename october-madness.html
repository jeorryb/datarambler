<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>October Madness: Better late than never - DataRambler</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://www.datarambler.com/october-madness.html">

        <meta name="author" content="Jeorry Balasabas" />
        <meta name="keywords" content="python,machine learning,data science" />
        <meta name="description" content="A walkthrough of my entry in Kaggle’s Machine Learning Mania 2017 contest." />

        <meta property="og:site_name" content="DataRambler" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="October Madness: Better late than never"/>
        <meta property="og:url" content="https://www.datarambler.com/october-madness.html"/>
        <meta property="og:description" content="A walkthrough of my entry in Kaggle’s Machine Learning Mania 2017 contest."/>
        <meta property="article:published_time" content="2017-10-18" />
            <meta property="article:section" content="Machine Learning" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="machine learning" />
            <meta property="article:tag" content="data science" />
            <meta property="article:author" content="Jeorry Balasabas" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://www.datarambler.com/theme/css/bootstrap.simplex.min.css" type="text/css"/>
    <link href="https://www.datarambler.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://www.datarambler.com/theme/css/pygments/native.css" rel="stylesheet">
        <link href="https://www.datarambler.com/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="https://www.datarambler.com/theme/css/style.css" type="text/css"/>

        <link href="https://www.datarambler.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="DataRambler ATOM Feed"/>

        <link href="https://www.datarambler.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate"
              title="DataRambler RSS Feed"/>



</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://www.datarambler.com/" class="navbar-brand">
DataRambler            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="https://www.datarambler.com/pages/about.html">
                             About
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://www.datarambler.com/october-madness.html"
                       rel="bookmark"
                       title="Permalink to October Madness: Better late than never">
                        October Madness: Better late than&nbsp;never
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2017-10-18T17:00:00-04:00"> Wed 18 October 2017</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://www.datarambler.com/tag/python.html">python</a>
        /
	<a href="https://www.datarambler.com/tag/machine-learning.html">machine learning</a>
        /
	<a href="https://www.datarambler.com/tag/data-science.html">data science</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="March-Madness-in-October?">March Madness in October?<a class="anchor-link" href="#March-Madness-in-October?">¶</a></h1><p>This post is a long time coming. Honestly, I meant to get this out last March but better late than never. This notebook was the method I used in cleansing and exploring data from the <a href="https://www.kaggle.com/c/march-machine-learning-mania-2017">2017 Kaggle Machine Learning Mania</a> competition. You could apply these techniques to any data where you are trying to predict a winner based off prior information. If you are interested in competing in a 
Kaggle competition I highly recommend this one. Especially if you are getting tired of Titanic datasets and flower petal measurements. Reading the past competition message boards was a huge help. I&#8217;ll try to sprinkle my thought process at different points to clarify for readers.&nbsp;Enjoy!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">fuzzywuzzy</span> <span class="k">import</span> <span class="n">process</span><span class="p">,</span> <span class="n">fuzz</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Exploration">Data Exploration<a class="anchor-link" href="#Data-Exploration">¶</a></h2><p>At this point I just wanted to see what kind of data I was dealing with. Luckily, kaggle already assigned each team a Team <span class="caps">ID</span> to keep me from having to perform any kind of&nbsp;normalization.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">teams</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./Teams.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">teams</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Of course I had to find out the team id of the home team.&nbsp;:)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">teams</span><span class="p">[</span><span class="n">teams</span><span class="p">[</span><span class="s1">'Team_Name'</span><span class="p">]</span><span class="o">==</span><span class="s1">'Georgia Tech'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also look up teams by team&nbsp;id.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">teams</span><span class="p">[</span><span class="n">teams</span><span class="p">[</span><span class="s1">'Team_Id'</span><span class="p">]</span><span class="o">==</span><span class="mi">1455</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rscr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./RegularSeasonCompactResults.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rsdr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./RegularSeasonDetailedResults.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tcr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./TourneyCompactResults.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The kenpom.csv is a external dataset that I obtained by scraping <a href="https://kenpom.com/">https://kenpom.com/</a>. I highly recommend looking at and consider using data from this site. Ken Pomeroy runs a college basketball ranking site and was recommended in previous march madness&nbsp;competitions.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./sample_submission.csv"</span><span class="p">)</span>
<span class="n">kp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./kenpom.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rscr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometimes it&#8217;s easier to view all the features by transposing the&nbsp;dataframe.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rsdr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rscr</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rsdr</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>No surprise here on the top 10 teams by total&nbsp;wins.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">top_10_reg</span> <span class="o">=</span> <span class="n">teams</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rscr</span><span class="p">[</span><span class="s1">'Wteam'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[:</span><span class="mi">9</span><span class="p">]),</span> <span class="n">how</span><span class="o">=</span><span class="s1">'right'</span><span class="p">)</span>
<span class="n">top_10_reg</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Team_Name'</span><span class="p">,</span> <span class="s1">'Total_Wins'</span><span class="p">]</span>
<span class="n">top_10_reg</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The feature we are trying to predict is the probability that team1 will win. In order to do this effectively we need to choose or engineer numerical features that we&#8217;ll know prior to the game occurring. The makeup of each team varies greatly from year to year. With that in mind I&#8217;ve decided to isolate my train and test data by&nbsp;year.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013</span> <span class="o">=</span> <span class="n">rsdr</span><span class="p">[</span><span class="n">rsdr</span><span class="p">[</span><span class="s1">'Season'</span><span class="p">]</span><span class="o">==</span><span class="mi">2013</span><span class="p">]</span>
<span class="n">rs2014</span> <span class="o">=</span> <span class="n">rsdr</span><span class="p">[</span><span class="n">rsdr</span><span class="p">[</span><span class="s1">'Season'</span><span class="p">]</span><span class="o">==</span><span class="mi">2014</span><span class="p">]</span>
<span class="n">rs2015</span> <span class="o">=</span> <span class="n">rsdr</span><span class="p">[</span><span class="n">rsdr</span><span class="p">[</span><span class="s1">'Season'</span><span class="p">]</span><span class="o">==</span><span class="mi">2015</span><span class="p">]</span>
<span class="n">rs2016</span> <span class="o">=</span> <span class="n">rsdr</span><span class="p">[</span><span class="n">rsdr</span><span class="p">[</span><span class="s1">'Season'</span><span class="p">]</span><span class="o">==</span><span class="mi">2016</span><span class="p">]</span>
<span class="n">rs2017</span> <span class="o">=</span> <span class="n">rsdr</span><span class="p">[</span><span class="n">rsdr</span><span class="p">[</span><span class="s1">'Season'</span><span class="p">]</span><span class="o">==</span><span class="mi">2017</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2014_d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2015_d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2016_d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2017_d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2014_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2015_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2016_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2017_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d1</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2013</span><span class="p">[[</span><span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span>  <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2014_d1</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2014</span><span class="p">[[</span><span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span>  <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2015_d1</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2015</span><span class="p">[[</span><span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span>  <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2016_d1</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2016</span><span class="p">[[</span><span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span>  <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2017_d1</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rs2017</span><span class="p">[[</span><span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d2</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2013</span><span class="p">[[</span><span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">,</span> <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2014_d2</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2014</span><span class="p">[[</span><span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">,</span> <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2015_d2</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2015</span><span class="p">[[</span><span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">,</span> <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2016_d2</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'t1_fgm'</span><span class="p">,</span> <span class="s1">'t1_fga'</span><span class="p">,</span> <span class="s1">'t1_fgm3'</span><span class="p">,</span> <span class="s1">'t1_fga3'</span><span class="p">,</span> <span class="s1">'t1_ftm'</span><span class="p">,</span> <span class="s1">'t1_fta'</span><span class="p">,</span> <span class="s1">'t1_ast'</span><span class="p">,</span> <span class="s1">'t1_dr'</span><span class="p">,</span> <span class="s1">'t1_stl'</span><span class="p">,</span> <span class="s1">'t1_pf'</span><span class="p">,</span> <span class="s1">'t1_blk'</span><span class="p">,</span> <span class="s1">'t2_fgm'</span><span class="p">,</span> <span class="s1">'t2_fga'</span><span class="p">,</span> <span class="s1">'t2_fgm3'</span><span class="p">,</span> <span class="s1">'t2_fga3'</span><span class="p">,</span> <span class="s1">'t2_ftm'</span><span class="p">,</span> <span class="s1">'t2_fta'</span><span class="p">,</span> <span class="s1">'t2_ast'</span><span class="p">,</span> <span class="s1">'t2_dr'</span><span class="p">,</span> <span class="s1">'t2_stl'</span><span class="p">,</span> <span class="s1">'t2_pf'</span><span class="p">,</span> <span class="s1">'t2_blk'</span> <span class="p">]]</span> <span class="o">=</span> <span class="n">rs2016</span><span class="p">[[</span><span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">,</span> <span class="s1">'Lfgm'</span><span class="p">,</span> <span class="s1">'Lfga'</span><span class="p">,</span> <span class="s1">'Lfgm3'</span><span class="p">,</span> <span class="s1">'Lfga3'</span><span class="p">,</span> <span class="s1">'Lftm'</span><span class="p">,</span> <span class="s1">'Lfta'</span><span class="p">,</span> <span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Ldr'</span><span class="p">,</span> <span class="s1">'Lstl'</span><span class="p">,</span> <span class="s1">'Lpf'</span><span class="p">,</span> <span class="s1">'Lblk'</span><span class="p">,</span> <span class="s1">'Wfgm'</span><span class="p">,</span> <span class="s1">'Wfga'</span><span class="p">,</span> <span class="s1">'Wfgm3'</span><span class="p">,</span> <span class="s1">'Wfga3'</span><span class="p">,</span> <span class="s1">'Wftm'</span><span class="p">,</span> <span class="s1">'Wfta'</span><span class="p">,</span> <span class="s1">'Wast'</span><span class="p">,</span> <span class="s1">'Wdr'</span><span class="p">,</span> <span class="s1">'Wstl'</span><span class="p">,</span> <span class="s1">'Wpf'</span><span class="p">,</span> <span class="s1">'Wblk'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rs2017_d2</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rs2017</span><span class="p">[[</span><span class="s1">'Lteam'</span><span class="p">,</span> <span class="s1">'Wteam'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d1</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rs2014_d1</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rs2015_d1</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rs2016_d1</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rs2017_d1</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_d2</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rs2014_d2</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rs2015_d2</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rs2016_d2</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rs2017_d2</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rs2013_d1</span><span class="p">,</span> <span class="n">rs2013_d2</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rs2014_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rs2014_d1</span><span class="p">,</span> <span class="n">rs2014_d2</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rs2015_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rs2015_d1</span><span class="p">,</span> <span class="n">rs2015_d2</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rs2016_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rs2016_d1</span><span class="p">,</span> <span class="n">rs2016_d2</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rs2017_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rs2017_d1</span><span class="p">,</span> <span class="n">rs2017_d2</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I did a little feature engineering by creating standard bball&nbsp;percentages.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fga'</span><span class="p">]</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fga3'</span><span class="p">]</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fta'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fga'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fga3'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fta'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fga'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fga3'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fta'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fga'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fga3'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fta'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fga'</span><span class="p">]</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fga3'</span><span class="p">]</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fta'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fga'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fga3'</span><span class="p">]</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fta'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fga'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fga3'</span><span class="p">]</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fta'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fgm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fga'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fgm3'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fga3'</span><span class="p">]</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_ftm'</span><span class="p">]</span> <span class="o">/</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fta'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I added a few more features by calculating each team&#8217;s trailing average for bbal percentages to try and encapsulate how a team was doing at that point in&nbsp;time.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_train</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Daynum'</span><span class="p">)</span>
<span class="n">rs2014_train</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Daynum'</span><span class="p">)</span>
<span class="n">rs2015_train</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Daynum'</span><span class="p">)</span>
<span class="n">rs2016_train</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Daynum'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_fg_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_fg3_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg3_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ft_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ft_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ast_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ast_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_dr_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_dr_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_stl_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_stl_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_pf_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_pf_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_blk_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t1_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_blk_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_fg_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_fg3_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg3_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ft_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ft_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ast_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ast_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_dr_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_dr_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_stl_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_stl_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_pf_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_pf_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_blk_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t1_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_blk_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_fg_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_fg3_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg3_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ft_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ft_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ast_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ast_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_dr_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_dr_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_stl_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_stl_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_pf_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_pf_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_blk_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t1_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_blk_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_fg_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_fg3_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_fg3_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ft_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ft_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_ast_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_ast_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_dr_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_dr_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_stl_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_stl_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_pf_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_pf_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t1_blk_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t1_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t1_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1_blk_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t2_fg_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_fg3_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg3_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ft_pct_avg_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ft_pct_avg_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ast_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ast_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_dr_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_dr_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_stl_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_stl_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_pf_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_pf_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_blk_2013</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'t2_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_blk_2013</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t2_fg_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_fg3_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg3_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ft_pct_avg_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ft_pct_avg_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ast_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ast_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_dr_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_dr_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_stl_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_stl_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_pf_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_pf_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_blk_2014</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'t2_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_blk_2014</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t2_fg_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_fg3_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg3_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ft_pct_avg_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ft_pct_avg_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ast_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ast_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_dr_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_dr_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_stl_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_stl_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_pf_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_pf_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_blk_2015</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'t2_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_blk_2015</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t2_fg_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fg_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_fg3_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_fg3_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_fg3_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_fg3_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ft_pct_avg_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ft_pct'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_ft_pct_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ft_pct_avg_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_ast_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_ast'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_ast_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_ast_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_dr_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_dr'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_dr_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_dr_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_stl_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_stl'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_stl_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_stl_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_pf_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_pf'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_pf_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_pf_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t2_blk_2016</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">'t2_blk'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'t2_blk_avg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2_blk_2016</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-the-Model">Training the Model<a class="anchor-link" href="#Training-the-Model">¶</a></h2><p>Now that my feature are how I want them it was time to train my model. I split my target variable, in this case whether team1 would win or lose (indicated by a 1 or 0 respectively) into it&#8217;s own&nbsp;array.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target13</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">target14</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">target15</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">target16</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I created my feature arrays separated by&nbsp;year.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features_array13</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">features_array14</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">features_array15</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">features_array16</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lrscores13</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logreg</span><span class="p">,</span> <span class="n">features_array13</span><span class="p">,</span> <span class="n">target13</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">lrscores14</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logreg</span><span class="p">,</span> <span class="n">features_array14</span><span class="p">,</span> <span class="n">target14</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">lrscores15</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logreg</span><span class="p">,</span> <span class="n">features_array15</span><span class="p">,</span> <span class="n">target15</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">lrscores16</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logreg</span><span class="p">,</span> <span class="n">features_array16</span><span class="p">,</span> <span class="n">target16</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lrscores13</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">lrscores14</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">lrscores15</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">lrscores16</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">rfscores13</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">features_array13</span><span class="p">,</span> <span class="n">target13</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">rfscores14</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">features_array14</span><span class="p">,</span> <span class="n">target14</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">rfscores15</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">features_array15</span><span class="p">,</span> <span class="n">target15</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">rfscores16</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">features_array16</span><span class="p">,</span> <span class="n">target16</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Random Forest CV Scores:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'min: </span><span class="si">{:.3f}</span><span class="s1">, mean; </span><span class="si">{:.3f}</span><span class="s1">, max: </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">rfscores13</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rfscores13</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">rfscores13</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'min: </span><span class="si">{:.3f}</span><span class="s1">, mean; </span><span class="si">{:.3f}</span><span class="s1">, max: </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">rfscores14</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rfscores14</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">rfscores14</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'min: </span><span class="si">{:.3f}</span><span class="s1">, mean; </span><span class="si">{:.3f}</span><span class="s1">, max: </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">rfscores15</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rfscores15</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">rfscores15</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'min: </span><span class="si">{:.3f}</span><span class="s1">, mean; </span><span class="si">{:.3f}</span><span class="s1">, max: </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">rfscores16</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rfscores16</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">rfscores16</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">GradientBoostingClassifier</span>

<span class="n">gb</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=.</span><span class="mi">8</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>

<span class="n">gbscores13</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="n">features_array13</span><span class="p">,</span> <span class="n">target13</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">gbscores14</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="n">features_array14</span><span class="p">,</span> <span class="n">target14</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">gbscores15</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="n">features_array15</span><span class="p">,</span> <span class="n">target15</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">gbscores16</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="n">features_array16</span><span class="p">,</span> <span class="n">target16</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Gradient Boosted Trees CV scores:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"min: </span><span class="si">{:.3f}</span><span class="s2">, mean: </span><span class="si">{:.3f}</span><span class="s2">, max: </span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">gbscores13</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gbscores13</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">gbscores13</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"min: </span><span class="si">{:.3f}</span><span class="s2">, mean: </span><span class="si">{:.3f}</span><span class="s2">, max: </span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">gbscores14</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gbscores14</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">gbscores14</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"min: </span><span class="si">{:.3f}</span><span class="s2">, mean: </span><span class="si">{:.3f}</span><span class="s2">, max: </span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">gbscores15</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gbscores15</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">gbscores15</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"min: </span><span class="si">{:.3f}</span><span class="s2">, mean: </span><span class="si">{:.3f}</span><span class="s2">, max: </span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">gbscores16</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gbscores16</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">gbscores16</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For now I&#8217;ll stick with Gradient Boosting as my classifier and I&#8217;ll start munging the test data that I&#8217;ll be using to make my predictions with. First I need to get the sample submission csv that Kaggle gave us into a format that I can use with&nbsp;scikit-learn.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ss</span><span class="p">[</span><span class="s1">'team1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ss</span><span class="p">[</span><span class="s1">'team2'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ss</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'pred'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ss</span><span class="p">[[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>
<span class="n">ss13</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[</span><span class="n">ss</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span><span class="o">==</span><span class="mi">2013</span><span class="p">]</span>
<span class="n">ss14</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[</span><span class="n">ss</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span><span class="o">==</span><span class="mi">2014</span><span class="p">]</span>
<span class="n">ss15</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[</span><span class="n">ss</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span><span class="o">==</span><span class="mi">2015</span><span class="p">]</span>
<span class="n">ss16</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[</span><span class="n">ss</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span><span class="o">==</span><span class="mi">2016</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2014_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2015_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">rs2016_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs2013_end</span> <span class="o">=</span> <span class="n">rs2013_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rs2014_end</span> <span class="o">=</span> <span class="n">rs2014_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rs2015_end</span> <span class="o">=</span> <span class="n">rs2015_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rs2016_end</span> <span class="o">=</span> <span class="n">rs2016_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_2013_end</span> <span class="o">=</span> <span class="n">rs2013_end</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">]]</span>
<span class="n">ss13</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss13</span><span class="p">,</span> <span class="n">t1_2013_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>
<span class="n">t2_2013_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">t2_2013_end</span><span class="p">[[</span><span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t1_2013_end</span>
<span class="n">ss13</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss13</span><span class="p">,</span> <span class="n">t2_2013_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_2014_end</span> <span class="o">=</span> <span class="n">rs2014_end</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">]]</span>
<span class="n">ss14</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss14</span><span class="p">,</span> <span class="n">t1_2014_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>
<span class="n">t2_2014_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">t2_2014_end</span><span class="p">[[</span><span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t1_2014_end</span>
<span class="n">ss14</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss14</span><span class="p">,</span> <span class="n">t2_2014_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_2015_end</span> <span class="o">=</span> <span class="n">rs2015_end</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">]]</span>
<span class="n">ss15</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss15</span><span class="p">,</span> <span class="n">t1_2015_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>
<span class="n">t2_2015_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">t2_2015_end</span><span class="p">[[</span><span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t1_2015_end</span>
<span class="n">ss15</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss15</span><span class="p">,</span> <span class="n">t2_2015_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1_2016_end</span> <span class="o">=</span> <span class="n">rs2016_end</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">]]</span>
<span class="n">ss16</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss16</span><span class="p">,</span> <span class="n">t1_2016_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>
<span class="n">t2_2016_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">t2_2016_end</span><span class="p">[[</span><span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t1_2016_end</span>
<span class="n">ss16</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ss16</span><span class="p">,</span> <span class="n">t2_2016_end</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_13</span> <span class="o">=</span> <span class="n">ss13</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_14</span> <span class="o">=</span> <span class="n">ss14</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_15</span> <span class="o">=</span> <span class="n">ss15</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_16</span> <span class="o">=</span> <span class="n">ss16</span><span class="p">[[</span><span class="s1">'t1_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_fg3_pct_avg'</span><span class="p">,</span> <span class="s1">'t2_ft_pct_avg'</span><span class="p">,</span> <span class="s1">'t1_ast_avg'</span><span class="p">,</span> <span class="s1">'t1_dr_avg'</span><span class="p">,</span><span class="s1">'t1_stl_avg'</span><span class="p">,</span><span class="s1">'t1_pf_avg'</span><span class="p">,</span><span class="s1">'t1_blk_avg'</span><span class="p">,</span> <span class="s1">'t2_ast_avg'</span><span class="p">,</span> <span class="s1">'t2_dr_avg'</span><span class="p">,</span><span class="s1">'t2_stl_avg'</span><span class="p">,</span><span class="s1">'t2_pf_avg'</span><span class="p">,</span><span class="s1">'t2_blk_avg'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_array13</span><span class="p">,</span> <span class="n">target13</span><span class="p">)</span>
<span class="n">t1_pred_prob_2013</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_13</span><span class="p">)</span>

<span class="n">gb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_array14</span><span class="p">,</span> <span class="n">target14</span><span class="p">)</span>
<span class="n">t1_pred_prob_2014</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_14</span><span class="p">)</span>

<span class="n">gb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_array15</span><span class="p">,</span> <span class="n">target15</span><span class="p">)</span>
<span class="n">t1_pred_prob_2015</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_15</span><span class="p">)</span>

<span class="n">gb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_array16</span><span class="p">,</span> <span class="n">target16</span><span class="p">)</span>
<span class="n">t1_pred_prob_2016</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds13</span> <span class="o">=</span> <span class="n">t1_pred_prob_2013</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ss13</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds13</span>
<span class="n">preds14</span> <span class="o">=</span> <span class="n">t1_pred_prob_2014</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ss14</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds14</span>
<span class="n">preds15</span> <span class="o">=</span> <span class="n">t1_pred_prob_2015</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ss15</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds15</span>
<span class="n">preds16</span> <span class="o">=</span> <span class="n">t1_pred_prob_2016</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ss16</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds16</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss13</span> <span class="o">=</span> <span class="n">ss13</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]]</span>
<span class="n">ss14</span> <span class="o">=</span> <span class="n">ss14</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]]</span>
<span class="n">ss15</span> <span class="o">=</span> <span class="n">ss15</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]]</span>
<span class="n">ss16</span> <span class="o">=</span> <span class="n">ss16</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss13</span> <span class="o">=</span> <span class="n">ss13</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ss14</span> <span class="o">=</span> <span class="n">ss14</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ss15</span> <span class="o">=</span> <span class="n">ss15</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ss16</span> <span class="o">=</span> <span class="n">ss16</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#ss_3_10_1635 = pd.concat([ss13, ss14, ss15, ss16], ignore_index=True)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#ss_3_10_1635.to_csv('ss_3_10_1635.csv', index=False)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following section involves using data from Ken Pomeroy. Various publications have indicated that these features are helpful in predicting <span class="caps">NCAA</span>&nbsp;matchups.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">teams</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">teams</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At this point I only needed to concentrate on results from 2017. The second half of the competition involved predicting all outcomes for the teams that had been selected for the <span class="caps">NCAA</span> tournament and their associated&nbsp;probabilities.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_2017</span> <span class="o">=</span> <span class="n">kp</span><span class="p">[</span><span class="n">kp</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span><span class="o">==</span><span class="mi">2017</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># kp_2017['Team'] = kp_2017['Team'].apply(lambda x: difflib.get_close_matches(x, teams['Team_Name']))</span>
<span class="c1"># kp_id17 = pd.merge(teams, kp_2017, how='left', left_on='Team_Name', right_on='Team')</span>
<span class="c1"># kp_id17</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_2017</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_id2017</span> <span class="o">=</span> <span class="n">kp_id2017</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Team_Id'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_id2017</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">kp_id2017</span><span class="p">,</span> <span class="n">rs2017_train</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'Team_Id'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span> <span class="o">=</span> <span class="n">kp_feat_17</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Team_Name'</span><span class="p">:</span><span class="s1">'t1_name'</span><span class="p">,</span> <span class="s1">'Rank'</span><span class="p">:</span><span class="s1">'t1_rank'</span><span class="p">,</span> <span class="s1">'Conference'</span><span class="p">:</span><span class="s1">'t1_conf'</span><span class="p">,</span> 
                           <span class="s1">'Wins'</span><span class="p">:</span><span class="s1">'t1_wins'</span><span class="p">,</span> <span class="s1">'Losses'</span><span class="p">:</span><span class="s1">'t1_losses'</span><span class="p">,</span><span class="s1">'Pyth'</span><span class="p">:</span><span class="s1">'t1_pyth'</span><span class="p">,</span> <span class="s1">'AdjustO'</span><span class="p">:</span><span class="s1">'t1_adjusto'</span><span class="p">,</span>
                           <span class="s1">'AdjustD'</span><span class="p">:</span><span class="s1">'t1_adjustd'</span><span class="p">,</span> <span class="s1">'AdjustT'</span><span class="p">:</span><span class="s1">'t1_adjustt'</span><span class="p">,</span> <span class="s1">'Luck'</span><span class="p">:</span><span class="s1">'t1_luck'</span><span class="p">,</span> <span class="s1">'SOS Pyth'</span><span class="p">:</span><span class="s1">'t1_sospyth'</span><span class="p">,</span>
                           <span class="s1">'SOS OppO'</span><span class="p">:</span><span class="s1">'t1_sos_oppo'</span><span class="p">,</span> <span class="s1">'SOS OppD'</span><span class="p">:</span><span class="s1">'t1_sos_oppd'</span><span class="p">,</span> <span class="s1">'NCSOS Pyth'</span><span class="p">:</span><span class="s1">'t1_ncsos_pyth'</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'Team_Id'</span><span class="p">,</span> <span class="s1">'Team'</span><span class="p">,</span> <span class="s1">'Daynum'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">kp_id2017</span><span class="p">,</span> <span class="n">kp_feat_17</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'Team_Id'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span> <span class="o">=</span> <span class="n">kp_feat_17</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Team_Name'</span><span class="p">:</span><span class="s1">'t2_name'</span><span class="p">,</span> <span class="s1">'Rank'</span><span class="p">:</span><span class="s1">'t2_rank'</span><span class="p">,</span> <span class="s1">'Conference'</span><span class="p">:</span><span class="s1">'t2_conf'</span><span class="p">,</span> 
                           <span class="s1">'Wins'</span><span class="p">:</span><span class="s1">'t2_wins'</span><span class="p">,</span> <span class="s1">'Losses'</span><span class="p">:</span><span class="s1">'t2_losses'</span><span class="p">,</span><span class="s1">'Pyth'</span><span class="p">:</span><span class="s1">'t2_pyth'</span><span class="p">,</span> <span class="s1">'AdjustO'</span><span class="p">:</span><span class="s1">'t2_adjusto'</span><span class="p">,</span>
                           <span class="s1">'AdjustD'</span><span class="p">:</span><span class="s1">'t2_adjustd'</span><span class="p">,</span> <span class="s1">'AdjustT'</span><span class="p">:</span><span class="s1">'t2_adjustt'</span><span class="p">,</span> <span class="s1">'Luck'</span><span class="p">:</span><span class="s1">'t2_luck'</span><span class="p">,</span> <span class="s1">'SOS Pyth'</span><span class="p">:</span><span class="s1">'t2_sospyth'</span><span class="p">,</span>
                           <span class="s1">'SOS OppO'</span><span class="p">:</span><span class="s1">'t2_sos_oppo'</span><span class="p">,</span> <span class="s1">'SOS OppD'</span><span class="p">:</span><span class="s1">'t2_sos_oppd'</span><span class="p">,</span> <span class="s1">'NCSOS Pyth'</span><span class="p">:</span><span class="s1">'t2_ncsos_pyth'</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'Seed_x'</span><span class="p">,</span> <span class="s1">'Team'</span><span class="p">,</span> <span class="s1">'AdjustO Rank_x'</span><span class="p">,</span> <span class="s1">'AdjustD Rank_x'</span><span class="p">,</span> <span class="s1">'AdjustT Rank_x'</span><span class="p">,</span> <span class="s1">'Luck Rank_x'</span><span class="p">,</span>
                <span class="s1">'SOS Pyth Rank_x'</span><span class="p">,</span> <span class="s1">'SOS OppO Rank_x'</span><span class="p">,</span> <span class="s1">'SOS OppD Rank_x'</span><span class="p">,</span> <span class="s1">'NCSOS Pyth Rank_x'</span><span class="p">,</span> <span class="s1">'Year_y'</span><span class="p">,</span> <span class="s1">'Seed_y'</span><span class="p">,</span> 
                <span class="s1">'AdjustO Rank_y'</span><span class="p">,</span> <span class="s1">'AdjustD Rank_y'</span><span class="p">,</span> <span class="s1">'AdjustT Rank_y'</span><span class="p">,</span> <span class="s1">'Luck Rank_y'</span><span class="p">,</span> <span class="s1">'SOS OppO Rank_y'</span><span class="p">,</span>
                <span class="s1">'SOS OppD Rank_y'</span><span class="p">,</span> <span class="s1">'NCSOS Pyth Rank_y'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp_feat_17</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'Team_Id'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target17</span> <span class="o">=</span> <span class="n">kp_feat_17</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features_array17</span> <span class="o">=</span> <span class="n">kp_feat_17</span><span class="p">[[</span><span class="s1">'t1_ncsos_pyth'</span><span class="p">,</span> <span class="s1">'t1_sos_oppd'</span><span class="p">,</span> <span class="s1">'t1_sos_oppo'</span><span class="p">,</span> <span class="s1">'t1_sospyth'</span><span class="p">,</span> <span class="s1">'t1_luck'</span><span class="p">,</span> <span class="s1">'t1_adjustt'</span><span class="p">,</span>
                               <span class="s1">'t1_adjusto'</span><span class="p">,</span> <span class="s1">'t1_adjustd'</span><span class="p">,</span> <span class="s1">'t1_pyth'</span><span class="p">,</span> <span class="s1">'t2_ncsos_pyth'</span><span class="p">,</span> <span class="s1">'t2_sos_oppd'</span><span class="p">,</span> <span class="s1">'t2_sos_oppo'</span><span class="p">,</span>
                               <span class="s1">'t2_sospyth'</span><span class="p">,</span> <span class="s1">'t2_luck'</span><span class="p">,</span> <span class="s1">'t2_adjustt'</span><span class="p">,</span> <span class="s1">'t2_adjusto'</span><span class="p">,</span> <span class="s1">'t2_adjustd'</span><span class="p">,</span> <span class="s1">'t2_pyth'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbscores17</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="n">features_array17</span><span class="p">,</span> <span class="n">target17</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Gradient Boosted Trees CV scores:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"min: </span><span class="si">{:.3f}</span><span class="s2">, mean: </span><span class="si">{:.3f}</span><span class="s2">, max: </span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">gbscores17</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gbscores17</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">gbscores17</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ssub</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./SampleSubmission.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ssub</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ssub</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ssub</span><span class="o">.</span><span class="n">Id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ssub</span><span class="p">[</span><span class="s1">'team1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ssub</span><span class="o">.</span><span class="n">Id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ssub</span><span class="p">[</span><span class="s1">'team2'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ssub</span><span class="o">.</span><span class="n">Id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ssub</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'Pred'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ssub</span><span class="p">[[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ssub</span><span class="p">[[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'team2'</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>
<span class="n">ss17</span> <span class="o">=</span> <span class="n">ssub</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span> <span class="o">=</span> <span class="n">ss17</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">teams</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'Team_Id'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For my final submission I decided to train my model using the regular season from 2017 and I used the features from the Ken Pomeroy ncaa statistics. The hardest part was getting the team names that Ken Pomeroy used to align with the team names that Kaggle provided in their data. After playing with multiple fuzzy string matching modules I found out that someone from Kaggle had already posted a file that had multiple spellings of team names with the official team id&#8217;s that Kaggle wanted in your submission file. This was a huge&nbsp;help.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kp2017_end</span> <span class="o">=</span> <span class="n">kp_feat_17</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'team1'</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">kp2017_end</span><span class="p">[</span><span class="s1">'team1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">kp2017_end</span><span class="p">[</span><span class="s1">'team1'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>


<span class="n">t1_2017_end</span> <span class="o">=</span> <span class="n">kp2017_end</span><span class="p">[[</span><span class="s1">'team1'</span><span class="p">,</span> <span class="s1">'t1_ncsos_pyth'</span><span class="p">,</span> <span class="s1">'t1_sos_oppd'</span><span class="p">,</span> <span class="s1">'t1_sos_oppo'</span><span class="p">,</span> <span class="s1">'t1_sospyth'</span><span class="p">,</span> <span class="s1">'t1_luck'</span><span class="p">,</span>
                          <span class="s1">'t1_adjustt'</span><span class="p">,</span><span class="s1">'t1_adjusto'</span><span class="p">,</span> <span class="s1">'t1_adjustd'</span><span class="p">,</span> <span class="s1">'t1_pyth'</span><span class="p">]]</span>

<span class="n">ss17</span> <span class="o">=</span> <span class="n">ss17</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">t1_2017_end</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'team1'</span><span class="p">)</span>

<span class="n">t2_2017_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">t2_2017_end</span><span class="p">[[</span><span class="s1">'team2'</span><span class="p">,</span> <span class="s1">'t2_ncsos_pyth'</span><span class="p">,</span> <span class="s1">'t2_sos_oppd'</span><span class="p">,</span> <span class="s1">'t2_sos_oppo'</span><span class="p">,</span> <span class="s1">'t2_sospyth'</span><span class="p">,</span> <span class="s1">'t2_luck'</span><span class="p">,</span>
                          <span class="s1">'t2_adjustt'</span><span class="p">,</span><span class="s1">'t2_adjusto'</span><span class="p">,</span> <span class="s1">'t2_adjustd'</span><span class="p">,</span> <span class="s1">'t2_pyth'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t1_2017_end</span>

<span class="n">ss17</span> <span class="o">=</span> <span class="n">ss17</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">t2_2017_end</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">)</span>
<span class="n">ss17</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_17</span> <span class="o">=</span> <span class="n">ss17</span><span class="p">[[</span><span class="s1">'t1_ncsos_pyth'</span><span class="p">,</span> <span class="s1">'t1_sos_oppd'</span><span class="p">,</span> <span class="s1">'t1_sos_oppo'</span><span class="p">,</span> <span class="s1">'t1_sospyth'</span><span class="p">,</span> <span class="s1">'t1_luck'</span><span class="p">,</span>
                <span class="s1">'t1_adjustt'</span><span class="p">,</span><span class="s1">'t1_adjusto'</span><span class="p">,</span> <span class="s1">'t1_adjustd'</span><span class="p">,</span> <span class="s1">'t1_pyth'</span><span class="p">,</span> <span class="s1">'t2_ncsos_pyth'</span><span class="p">,</span>
                <span class="s1">'t2_sos_oppd'</span><span class="p">,</span> <span class="s1">'t2_sos_oppo'</span><span class="p">,</span> <span class="s1">'t2_sospyth'</span><span class="p">,</span> <span class="s1">'t2_luck'</span><span class="p">,</span>
                <span class="s1">'t2_adjustt'</span><span class="p">,</span><span class="s1">'t2_adjusto'</span><span class="p">,</span> <span class="s1">'t2_adjustd'</span><span class="p">,</span> <span class="s1">'t2_pyth'</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_array17</span><span class="p">,</span> <span class="n">target17</span><span class="p">)</span>
<span class="n">t1_pred_prob_2017</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_17</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds17</span> <span class="o">=</span> <span class="n">t1_pred_prob_2017</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ss17</span><span class="p">[</span><span class="s1">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds17</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span> <span class="o">=</span> <span class="n">ss17</span><span class="p">[[</span><span class="s1">'Id'</span><span class="p">,</span> <span class="s1">'pred'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span> <span class="o">=</span> <span class="n">ss17</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Id'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss17</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ss17.to_csv('kp_gb_2017.csv', index=False)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the end, I completely screwed up by thinking I had extra time to submit my result by assuming the deadline was in <span class="caps">EST</span>. In fact, it was in <span class="caps">UTC</span> and I completely missed the deadline. I had a lot of fun and plan on competing in the 2018 competition. In retrospect I probably need to find a way to incorporate Vegas odds in my model. Most of the research I read implied that Vegas odds were very helpful in predicting winners. I also need to figure out how to introduce a certain amount of randomness in the outcome. Research also indicates that the best any model can get to predicting the outcome of any sport in around 80%. I guess that&#8217;s why they say sports is the <span class="caps">ULTIMATE</span> reality&nbsp;tv.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <!-- AddThis Button END -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://github.com/jeorryb"><i class="fa fa-github-square fa-lg"></i> github</a></li>
    <li class="list-group-item"><a href="https://twitter.com/jeorryb"><i class="fa fa-twitter-square fa-lg"></i> twitter</a></li>
    <li class="list-group-item"><a href="https://www.linkedin.com/in/jeorry"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Twitter Timeline -->
<li class="list-group-item">
  <h4><i class="fa fa-twitter fa-lg"></i><span class="icon-label">Latest Tweets</span></h4>
  <div id="twitter_timeline">
    <a class="twitter-timeline" data-width="250" data-height="300" data-dnt="true" data-theme="light" href="https://twitter.com/@jeorryb">Tweets by @jeorryb</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</li>
<!-- End Sidebar/Twitter Timeline -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container-fluid">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2017 Jeorry Balasabas
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://www.datarambler.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://www.datarambler.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://www.datarambler.com/theme/js/respond.min.js"></script>

    <script src="https://www.datarambler.com/theme/js/bodypadding.js"></script>


        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-59322469c36b0975"></script>
</body>
</html>